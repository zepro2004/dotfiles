# Make tmux use the same SSH_AUTH_SOCK as the shell that launched it
# Refresh SSH_AUTH_SOCK from shell on new panes
set-option -g update-environment "SSH_AUTH_SOCK"

# Reload config with prefix + r
unbind r
bind r source-file ~/.tmux.conf \; display-message "Config reloaded!"

# Set prefix to Ctrl+s (make sure flow control is disabled in shell with: stty -ixon)
set -g prefix C-s
bind C-s send-prefix  # bind prefix key to itself for nested tmux

# Enable mouse support
set -g mouse on

# Set window and pane base index to 1 (more natural numbering)
set-option -g base-index 1
set-option -g pane-base-index 1

# Bindings for moving windows by holding prefix and using arrow keys
bind -r Left  move-window -t -1
bind -r Right move-window -t +1

# Pane navigation with vim-style keys
bind-key h select-pane -L
bind-key j select-pane -D
bind-key k select-pane -U
bind-key l select-pane -R

# Set status bar position to top
set-option -g status-position top

# Use 256 color terminal with true color support
set-option -g default-terminal "tmux-256color"
set-option -ga terminal-overrides ",xterm-256color:Tc"

# Load shell as login shell for full environment
set-option -g default-command "${SHELL} -l"

# Plugin configurations
set -g @resurrect-save-on-exit 'yes' # Save tmux state on exit
set -g @continuum-restore 'on' # Enable tmux-resurrect and tmux-continuum
set -g @continuum-save-interval '2' # Save every 2 minutes 
set -g @prefix_highlight_output_prefix 'î©± ' # Prefix highlight output prefix 

# Plugins list
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'catppuccin/tmux#v2.1.3'
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'tmux-plugins/tmux-battery'
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'tmux-plugins/tmux-resurrect'

# Status line settings
set -g status-interval 5 # Update status every 5 seconds
set -g status-right-length 100 
set -g status-left-length 100 
set -g status-left "" 

set -ag status-left "#{E:@catppuccin_status_session}" # Use catppuccin theme for session name
set-option -g status-justify centre # Center align the status line  

set -g status-right "#{E:@catppuccin_status_application}"
set -agF status-right "#{E:@catppuccin_status_cpu}"
set -ag status-right "#{E:@catppuccin_status_uptime}"

# Optional: Aggressive pane resizing when tmux window resizes
setw -g aggressive-resize on # Enable aggressive pane resizing

# Convenient window and pane creation shortcuts
bind c new-window
bind | split-window -h
bind - split-window -v
bind-key C-a last-window  # Switch to last window with Ctrl+a

# Resize panes with Shift + arrow keys
bind -r S-Left resize-pane -L 5
bind -r S-Right resize-pane -R 5
bind -r S-Up resize-pane -U 3
bind -r S-Down resize-pane -D 3

# Toggle zoom for the current pane with prefix + z
bind-key z resize-pane -Z

# List all sessions with prefix + s
bind-key s choose-session

# Rename current window with prefix + ,
bind-key , command-prompt "rename-window %%"

# Clipboard integration: copy to system clipboard with prefix + y
bind-key y run-shell "tmux save-buffer - | xclip -selection clipboard -i"


# Initialize TMUX plugin manager (keep this line at the very bottom)
run '~/.tmux/plugins/tpm/tpm'

